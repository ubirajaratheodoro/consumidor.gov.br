<!DOCTYPE html>
<meta charset="utf-8">
<html>
<head>
	<title>Consumidor Gov Br</title>
	<script src="https://d3js.org/d3.v4.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/dimple/2.3.0/dimple.latest.min.js"></script>
</head>

<body>
	<div id="chartContainer">
		<script type="text/javascript">
			// delimita o espaço e o tamanho do gráfico à ser exibido
			var svg = dimple.newSvg("#chartContainer",960,500);
			d3.csv("ProsperLoanDataResume.csv",function(data)
			{
				// declara as variáveis para dimensionar 2 gráficos
				// (principal + lateral)
				var padding = 55,
					width = 960,
					height = 500,
					rightBar = 0,
					legendheight = height/4;

				// cria e delimita chart principal
				var chart = new dimple.chart(svg,data);
				chart.setBounds(padding, 2*padding + 10,
								width - rightBar - 2 * padding, 
								height- 3* padding - 10);
				
				// declara os gráficos a serem exibidos com o evento mouseover
				var tipchart1 = null;
				var tipchart2 = null;
				
				// configura o eixo X do gráfico principal
				var x = chart.addCategoryAxis("x", "FDebtToIncomeRatio");
				x.title = "% de Comprometimento da Renda (DebtToIncomeRatio)";
				x.fontSize = 12;

				// configura o eixo Y do gráfico principal
				var y = chart.addCategoryAxis("y", "FBorrowerAPR");
				y.title = "% de juros anuais (BorrowerAPR)";
				y.fontSize = 12;
				
				// configura o eixo Z do gráfico principal
				var z = chart.addMeasureAxis("z", "LoanOriginalAmount");
				z.overrideMin = 0;
				z.overrideMax = 40000000;
			
				// configura a série de dados do gráfico principal
				var s_bubble = chart.addSeries("FDebtToIncomeRatio", 
												dimple.plot.bubble);
				s_bubble.radius = 40;
				s_bubble.addOrderRule("FDebtToIncomeRatio");

				// adicona o evento mouseover à série de dados para abrir gráfico auxiliar
				s_bubble.addEventHandler("mouseover", onHover);
				
				// adicona o evento mouseleave à série de dados para remover gráfico auxiliar
				s_bubble.addEventHandler("mouseleave", onLeave);
				
				// altera a configuração de cores padrão do gráfico principal
				chart.defaultColors = [
					new dimple.color("silver") // You can use #RGB here
				];

				//------------------------
				// exibe gráfico principal
				//------------------------
				chart.draw();
		
		</script>
	</div>
	
</body>
</html>